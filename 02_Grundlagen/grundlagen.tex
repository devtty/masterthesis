\chapter{Grundlagen}

\anno{bitte nicht mehr als 8 Seiten}

% Grundbegriffe 2 Seiten
\section{Grundbegriffe}
\subsection{WAF allgemein}
Um die Sicherheit einer Anwendung zu gewährleisten sind viele verschiedene Schritte notwendig, so sollten natürlich bereits in der Anwendung selbst Ein- und Ausgabemöglichkeiten, z.B. durch Validierung, Encoding, usw. überprüft und gegebenenfalls eingeschränkt werden. Dabei lässt sich nicht jeder mögliche Angriffsfall vorhersehen oder eine eigene Implementierung ist zu aufwendig und teuer, weil häufig nicht ausreichend personelle Ressourcen oder Bugdet vorhanden sind um eine Web Applikation auf alle möglichen Sicherheitslücken zu prüfen. Im Laufe des Betriebes einer Web Anwendungen können zudem neue Angriffsvarianten entstehen und zusätzlich ist gerade bei Web Applikationen der Zeitdruck zur Veröffentlichung einer solchen häufig sehr hoch.

An diesem Punkt kommen sogenannte Web Application Firewalls ins Spiel. Im Gegensatz zu regulären Firewalls haben Web Application Firewalls direkten Zugriff auf die HTTP-Anfragen (requests) und Antworten (responses) und können diese entsprechend bewerten und gegenbenenfalls blockieren oder gefährdende Inhalte filtern oder umschreiben.\\\\
%% 
\textcolor{bhtGray}{\ding{110} Definition\footnote{\url{https://owasp.org/www-community/Web_Application_Firewall} abgerufen am 30.05.2023}} A web application firewall is an application firewall for HTTP applications. It applies a set of rules to an HTTP conversation. Generally, these rules cover common attacks such as Cross-site Scripting (XSS) and SQL Injection. While proxies protect generally protect clients, WAFs protect servers. A WAF is deployed to protect a specific web application or set of web applications. A WAF can be considered a reverse proxy. WAFs may come in the form of an appliance, server plugin, or filter, and may be customized to an application to an application. The effort to perorm this customization can be significant and needs to be maintained as the application is modified.\\\\
%%
asd



\subsubsection{Anwendungsfälle}
%% Anwendungsfaelle WAF (gut beschrieben bei WAFEC2)
%% irgendwie Uebergang zu ML und WAF mit ML schaffen
%% Sammlung; payload,fuzzer,fingerprinting, bypassing

\subsection{Arten}

\subsubsection{Unterscheidung nach Position}
Grundsätzlich lassen sich solche Systeme nach ihrer Position in der Netzwerk- und Servertopologie unterscheiden. Es existieren einerseits Systeme die vor eine Anwendung geschaltet werden und Systeme die direkt in die Anwendung integriert werden. Die erste Gruppe lässt noch eine Verzweigung in weitere Unterarten, wie \emph{Reverse Proxy}, \emph{Appliance}, \emph{Plugins} für WebServer oder \emph{Passive Devices} (IDS), zu.


\subsubsection{Unterscheidung nach Abwehrmaßnahmen}

\paragraph{Regelbasierte Systeme}
Der Großteil bekannter WebApplicationFirewalls arbeitet jedoch \emph{regelbasiert}. In diesem Fall werden ein- und ausgehende Datenströme (Requests/Responses) unabhängig voneinander (zustandslos) betrachtet und einer Mustererkennung unterworfen. Häufig sind die Regeln anhand sogenannter \emph{Regular Expressions} definiert.

\paragraph{Logische Systeme}
Bei logikbasierten Abwehrmaßnahmen handelt es sich um Abwehrmaßnahmen die aufgrund von bekannten (logischen) Rückschlüssen eingeleitet werden. Einfachstes Beispiel wäre das temporäre Sperren der Loginseite bei dreimalig falschem Login. Bei Nutzung einer WAF die keine logikbasierten Auswertungen ermöglicht, müssten entsprechende Anwendungsfälle in der Anwendung selbst implementiert werden. (Oder im Fall der gerade beschriebenen Authentifizierungproblematik in einen externen Dienst ausgelagert werden.)

\subsection{Grundbegriffe allgemein}

\textbf{Bypassing:}

\textbf{Filter:}

\textbf{Fingerprinting:} Ähnlich der Abnahme und Identifizierung von Personen mit Hilfe eines individuellen Fingerabdrucks können auch Produkte wie Software anhand spezifischer Merkmale identifiziert werden. Beim \emph{Fingerprinting}

\textbf{Fuzzer:}

\textbf{Payload:}

\textbf{Request:} 

\textbf{Response:}

\section{Related Work} %umbenennen ca. 6

% Thema 1
\subsection{Evolution der Firewalls}

\subsubsection{Strikt nach Regeln}

Die praktisch einfachste Web Application Firewall wäre \emph{-beispielsweise-} eine einfache Regel innerhalb der Webserver-Konfiguration, die anhand eines bestimmten Merkmals den Datenverkehr entweder korrekt beantwortet oder \glqq\emph{abwehrt}\grqq. Wenn nicht explizit entnommen findet sich der folgende Eintrag in jeder Konfiguration des \emph{Apache httpd}-Servers und sorgt dafür dass der Zugriff auf jede Datei deren Dateiname mit \texttt{.ht} beginnt unterbunden wird:

\lstset{language=XML,
 	basicstyle=\ttfamily\color{black}\small,
 	keywordstyle=\bfseries\color{bhtBlue},
 	identifierstyle=\color{black}, 
 	commentstyle=\color{gray}\textsl
      }
%      \begin{figure}
%        \caption{Beispiel für einfache Regel}
%        \label{fig:httprule}
\begin{lstlisting}
  <Files ".ht*">
    Require all denied
  </Files>
\end{lstlisting}
%      \end{figure}

Mit steigender Komplexität der zu schützenden Anwendungen steigt auch der Bedarf an Regeln. Zu berücksichtigende Auswahlkriterien beschränken sich dann auch nicht nur auf den \glqq\emph{Dateinamen}\grqq. Attribute wie der Aufrufzeitpunkt, der Inhalt des Aufrufs, die Identität des Aufrufenden und viele andere Kriterien können zu entscheidenden Faktoren werden. Im Sinne der Entkopplung wurde diese Filterlogik häufig in entsprechende Module oder Plugins ausgelagert. Bekanntester Vertreter ist das \emph{modSecurity}-Modul für den Apache httpd-Server.

\begin{lstlisting}
  SecRule REQUEST_URI ".ht*" "deny"
\end{lstlisting}

% einfache regel => firewall
% Systeme zum verwalten der Regeln
% Standardisierte Regeln (OWASP CRS)

\subsubsection{Hybride Ansätze}

% Krueger Manaseer etc.

\subsubsection{Fortschritte in Richtung Intelligenz}

Collaborative Detection \cite{karakannas2014}

% kruegel gimenez appelt kozik testen mit ML Ansätzen

% Thema 2
\subsection{Thema 2 - ML}

%ansaetze und kombination?

% Thema 3 optional die andere seite
\subsection{hacking Wafs}


% Zusammenfassung (ca. 0,5 Seiten)
\section{Zusammenfassung}

% ggf. ditaa tabelle ueber den Zeitverlauf der verschiedenen Arbeiten nach Attack-Defend-Muster
